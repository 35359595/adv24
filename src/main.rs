use std::collections::{HashMap, HashSet};

fn main() {
    let lines = INPUT.split("\n");
    let pairs: Vec<(i32, i32)> = lines
        .into_iter()
        .map(|line| {
            let mut split = line.split("   ");
            (
                split.next().unwrap().parse().unwrap(),
                split.next().unwrap().parse().unwrap(),
            )
        })
        .collect();
    let (mut left, mut right) =
        pairs
            .into_iter()
            .fold((Vec::new(), Vec::new()), |mut acc, (l, r)| {
                acc.0.push(l);
                acc.1.push(r);
                acc
            });
    let mut recurring: HashMap<i32, i32> = HashMap::default();
    right.iter().for_each(|i| {
        recurring
            .entry(*i)
            .and_modify(|occured| *occured += 1)
            .or_insert(1);
    });
    let unique: HashSet<i32> = left.clone().into_iter().collect();
    let occurances = unique
        .into_iter()
        .fold(0, |acc, n| acc + n * recurring.get(&n).unwrap_or(&0i32));
    left.sort();
    right.sort();
    let total: i32 = left
        .into_iter()
        .zip(right.into_iter())
        .map(|(l, r)| (l - r).abs())
        .sum();
    println!("Day 1 q 1: {}\nDay 1 q 2: {}", total, occurances);

    // Day2
    let reports = INPUT2.split("\n");

    fn validate_report_reduce(
        start: Option<usize>,
        mut next: impl Iterator<Item = usize>,
        failed: u8,
    ) -> u8 {
        if let Some(s) = start {
            if let Some(n) = next.next() {
                if s > n && s - n < 4 {
                    validate_report_reduce(Some(n), next, failed)
                } else {
                    // removing 1 level
                    validate_report_reduce(Some(s), next, failed + 1)
                }
            } else {
                failed
            }
        } else {
            validate_report_reduce(next.next(), next, failed)
        }
    }

    fn validate_report_increase(
        start: Option<usize>,
        mut next: impl Iterator<Item = usize>,
        failed: u8,
    ) -> u8 {
        if let Some(s) = start {
            if let Some(n) = next.next() {
                if s < n && n - s < 4 {
                    validate_report_increase(Some(n), next, failed)
                } else {
                    // removing 1 level
                    validate_report_increase(Some(s), next, failed + 1)
                }
            } else {
                failed
            }
        } else {
            validate_report_increase(next.next(), next, failed)
        }
    }

    let (valid_count, once_failed) = reports.into_iter().fold((0, 0), |acc, r| {
        let report: Vec<usize> = r
            .trim()
            .split(" ")
            .into_iter()
            .map(|d| d.parse().unwrap())
            .collect();
        let i = validate_report_increase(None, report.clone().into_iter(), 0);
        let d = validate_report_reduce(None, report.into_iter(), 0);
        if i == 0 || d == 0 {
            (acc.0 + 1, acc.1)
        } else if i == 1 || d == 1 {
            (acc.0, acc.1 + 1)
        } else {
            acc
        }
    });

    println!(
        "Day 2 task 1: {valid_count}\nDay 2 task 2: {}",
        once_failed - 1 // IDK why
    );

    // Day 3
    use regex::Regex;

    let r = Regex::new(r"(mul\((?<a>[0-9]{1,3}),(?<b>[0-9]{1,3})\))").unwrap();
    let no_donts = INPUT3
        .split("do()")
        .map(|x| {
            x.find("don't()")
                .map(|idx| &x[..idx])
                .unwrap_or(x)
                .to_string()
        })
        .fold(String::new(), |a, n| a + &n);
    let result: usize = r
        .captures_iter(INPUT3)
        .map(|cap| &cap["a"].parse::<usize>().unwrap() * &cap["b"].parse().unwrap())
        .sum();

    let result_2: usize = r
        .captures_iter(&no_donts)
        .map(|cap| &cap["a"].parse::<usize>().unwrap() * &cap["b"].parse().unwrap())
        .sum();
    println!("Day 3 part 1: {result}\nDay 3 part 2: {result_2}");
}

const INPUT3: &str = r#"-select()&how()''from()}what()mul(667,142);*when()*/%%+ &mul(139,116),,)mul(665,813)$>-+from()where(),from()mul(589,293))mul(832,177)mul(701,929)~([mul(300,986)from()mul(238,716)/~*~'what()when():}mul(437,789)mul(662,564)*)^,;%<}#'mul(567,346)don't()from()-who(),^/mul(939,542)mul(944,786)^}select()(mul(508,210)}mul(873,534)}select()where()-,*+)#@mul(925,280)where()*who()why()who()?%:mul(858,972)+mul(113,350)' *who()+from(641,444))&]*don't();from()+,@[mul(522,403)mul(627,14)why()where()+/#^!what()^mul(678,234) <mul(520,505):how()()[from()select()mul(500,879)~{:-:{~mul(163,615)[~;>mul(79,303)from()from()^'who()@;/~[mul(752,220);-don't()((select()select(){mul(454,158) *]#mul(387,262)how()where()<select()#]mul(904,366)]?<what()>when()[from(118,182)mul(662,176)%]')from()where()mul(259,178)--)~>$who()do()where()&&]~@{)%]mul(566,269);select()%}%+ mul(21,147),#&)*'why()#+don't()-,:{/%what()$*mul(883,511)select(264,142)select()how()]/?&&mul(205,770)select()%from()what()&$select()who())mul(538,114)/mul(9,272)from()?(why(727,269)when()don't()>+/ when(),)mul(750,773)*['do()]mul(316,235)+{{mul(744,197)*#who()*}how()how()why())mul(932,794)*where())+<-/ mul(371,760)why() who()(select()@mul(595,45)who()%how()'when()>how(){why()[mul(123,779)!@where()(mul(988,620)~'*,?/#when()mul(612,810)mul(720,939)]/(,^&how()%^]mul(391,308);&@-mul(525,708)+what(352,33)when()from()why()} ~mul(79,405)@*where()! mul(865,388) <mul(33,948)~?(}!??+from()why()mul(302,201)[{mul(585,486)mul(821,363)who(314,751)what()*,]{when()mul(101,727)]}#)mul(808,363):?&#why()select()+mul(98,877) select()~<what(651,799)+;~ )mul(766,538):[<:#[mul(501,413);!why()<&>?[$what()mul(747,941)#[}from() ((mul(418,822)mul(90,638)select()(#;;<[+@mul(657,611)]}@)mul(30,874)@mul(525,145))who() where()+:~+]mul(176,137)what()] mul(381,84)):how()<who()from():&when()+mul(175,258);who(818,691)mul(634,219){select(846,719)'where()what()^;)[#mul(648,322) $mul(127#<{#mul(965,174)mul(611,623)#?%;,:,don't()* when()}&&mul(952,606),>mul(315,467)%($'(*]:%mul(792,258)]>'mul(534+[#>&)+why()mul(881,357):^*?what()who(514,882)where())}-mul(88,883[;^-#mul(208,713)}?;]!%mul(651,918);{),:what()*mul(528,154)):@*]; &%[mul(542,543)mul(480,848)why()mul(843,903)[select())-*@ ;who()mul(77,706)<[;}mul(303,968));why()mul(916,126)&&%/&mul(462,652)[!~()what()from()from()select()how()mul(730,810/,when(286,584)don't()^select()mul(609,219)(-~&who():mul(135,454)from()-%~]#mul(909,564)when()&why(){/~+?who()[do()mul(852,307)-[?;)how()do()[[*->{!#^mul(678,864)>when()%>!']$mul(16,905),!mul(111,596)why()$mul(2,397)/-@}~;where(942,895)do()who()where()<}when()?mul(846,421),?(where()why(),how()(&mul(643,890)%~*[;% $what()don't()^$&(##mul(112,802)where()^ &(&&{&do()+(!(mul(732,198)[}!'>^%mul(919,810)mul(342,316))}what()&~:~$<when()do()*what()+:>mul(822,157)-,{select()who()mul(907,36>where()/$!^<&$where()mul(10,661)-who()mul(496,782)@%%?'{[;(mul(110,115)~mul(447,69)*[what()[{]>-'@mul(197,810)select()what()who()mul(492,647)where()*[{ [~&what()$mul(24%<>mul(234,703)
)$~where()when()@when(),mul(939,238){from()(#!><mul(340,605)-~mul(211,57)#!where()#~+mul(21,844#where()when()who()#!why()^?{-mul(565,649)*how()mul(489,506)what()>-mul(44,294)what()where(244,294)*when()&&what()who()what()mul(173,998)+mul(915,924)mul(126{'*mul(849,404)#select()mul(480,290)('%what()}),%'mul(525,37) /;mul(371,488{<who(210,427)++select()who()@%mul(886,752)mul(251when()&']select()why(): ?mul(271,611)#what()from(667,868)*why()'$mul(979,932)where()mul(97,326)select()!#why()when()mul(408,436)<#[,when()$mul(962,805)})$'mul)&?><$,what()mul(652,384)+/+']:^;;what()mul(463,163)[$<who()mul(655,577)!&~why()-?mul(33,901)#what()!&why()>mul(692,303)@(&'+<mul(705,862)how()what(){>'how()mul(574,785)select()?why():<when()mul(828,721)'who()@,&#+&why()mul(319,336):*+),-mul(590,602)@;:}from()mul(392,532),do()how(97,299);'when()mul(443,364)/<what()@why()how(267,551)where()&$;mul(939,815)[#mul(247,538)what()how()?mul(481,220)mul(761,577):who()from() ^}&+mul(331,667)select() >>when(579,794)>mul(385,563)>-%where():(^)mul(349,597)select()- '(why())mul(325,80)mul(83]}[[^*how() why()<mul(985,98)how()who())mul;<:mul(644,216)'who()$<^!select()@,mul(287,310)%select()^what(){<(*,mul(589,290)^-/;#select()mul(244,439)mul(28,263),how()$;,)!$<mul(676<mul(439,221)%[;mul(192,22)[mul(304,482),-mul(757,972)mul(489&what()~&^:'~<mul(483,773)+@}> don't()mul(807,644)-who()$mul(716,166);select()mul(626,79)/don't()!( why()mul(496,577)~how()':!what()'@,mul(44what()where()how()?who()<mul(21,315)from()#when():when()mul(859,48)$when()-,+mul(888,917)mul(609,468)(]}$where()~mul(936,753),how()+how()>mul(115,627)^&'from()% mul(28,698)+why()mul(7,895)'mul(150#$[{<!#>]:mul(370,234)}why()# &{)mul(902,182))}*+^where():why()mul(263,783)who()]#;(-!why()$mul(635,217from()from();%+:$;^)mul(505,91)}''%${mul(467,336)}]]mul(323,115)^^why()why()%?>$>!mul(314,474)when()!'},%*select(),when()do()]':mul(748,29)why()select()'&^}~&from(),mul(55,11)[*/&who()&&mul(478,127)]-when()mul(64,831)what()/;[[mul(822,263)mul(833,138)>,$;how(843,918)>#mul(180,9)&what(136,915):;mul(883,785)mul(544,853)%mul(547,842)?select()^~:((mul(475,655)'^+[mul(70,929)when()from()+from()}[why()?'why()mul(88,259)from()[:who()<<mul(201,880)/)&mul(824,474){?what()where()+what()when()!&,mul(405,309)mul(74,297)$[how()mul(640,143);*'?&>mul(140,477)>&$where(602,252)-;;% {mul/@ ${select() !mul(167,943)what()[)mul(753,926)}$+#$mul(167,13)mul(456,116)mul(109,352)>]select()/'<mul(648,515)select()why()don't()mul(132,771)[[ mul(160,607)from()mul(495,410){-!what(731,360)from()> when()!mul(820,444),, (*mul(227,538)@:%{mul(168,817)from()/where():$ />who(795,19)-mul(799,466)~;(;from()-$)){mul(356,431)!from()*$what()mul(175,543)*mul(340,188)when():where()mul(613,955)from()~do()where(){mul(733,695) @mul(96,566)how()^what()how()'$what()]mul(303,135)]//who()(who()+mul){;^,mul(515,424) ]/%select()]mul(283,274)'>;*~from(){{from()?mul(869,316)
';[why()mul(719,314)-mul(38,357):]how()*/how()select()mul(78,942);$+#from()mul(265,330)from()from()& +-@-,mul(148,251)where()})why()/mul(159,418)%<},-?!^!~mul(632,32),don't()what()what()]>when()-#when()]mul(518,898)mul(64,74)mul(624,359){-*}mul(435,903)how()select()%where(36,5)(mul(750,885)*where()mul(15,112)<why() (who()select()}!mul(301,774)*&}/*~select(),mulwhere()who()do()from()#{#[&)[mul(485,891)mul(645,778)-#>?:%select()@<[mul(913,903));[from()#&*mul(511,123)+%when()&^'#mul(495,296,;what()mul(56,831) #[>/*(>+^mul(806,137)))/@*@}mul(395,547)'select(){what()why()*where():!don't()~!mul(112,799)(%from()*who(172,318)mul,)!&mul(590,625)$mul(516,115)how()[*!>mul(914,404)~when()](what()*mul(400,936)how()*^^{<{%?mul(999,987)!})#]mul(959,690)@{'}:{when()when()mul(570,284);~mul(97,397)@;#mul(132,335)?~#mul(42,819))mul(655,746){#^%who(101,15)&#!mul(291,803),#+?&mul(816,961);}mul(122,643)?~*#what()@;what()mul(711,201)why()(~]?&mul(529,206)from()where()%@from() /]mul(444,963)@who()from()/:[(-mul(346,877))/<!;&why()mul(883,670)[&how()+<why()select()!mul(257,88)from()-->when()&mul(177,443)$![%<mul(138,786)!%select()%what()-mul(71,360) ,!mul(852select(981,300)@mul(582,394)^/$,why())~%mul(511,491)[,)$~[{$^!mul(904>;@don't()][mul(677,276)*mul(353,913)select()from()*mul(695,847)/mul(20,815()who())})mul(438,161)select():why()who()*]^]mul(321,822)*^from()/where()-?{mul(718,349)mul(355,582)<;mul(830,962)mul(312,508))from()where()who())&why()>]do()mul(224,71)@(how()why()select(688,447)mul(89,792)#mul(154,938)select()do() who()}$!!&mul(172,622))$what(){>mul(623,570)&%-where():&*}mul(31,554)<(#where()*from():{@!mul(987,776))*'/mul+?(mul(701,61)~];}><{&mul(563,85):^^how()(mul(868,860)~,what()@{do()'why()mul(819,142)<$how()&mul(299,411)?mul(954,291){'-where()>mul(985 ~^why()?mul(131,20)*/ >from()',++>mul(415,335)?[-mul(798,190)^who()>;[mul(611,479)mul(658,622~,who()/&#:{who()}?mul(291,148)+where()}@who(51,417)what()why())<mul(568,202)>why()?:{*[!;mul(627,512):[;<':*mulwhy()((@)$$ ':don't()what(511,960)mul(159,248); mul(588,419)-#%<when()mul(372,2)'!+<-mul(372,361)+{why()(how()%do()]who()mul(933,797)%}>(mul(331,93}from()>mul(560,438)}from()mul(729,489)}*<@what()mul(456,993)]+-('@mul(164,410)@%+mul(283,493)<*;/ :when()((mul(266,486)[when(),?+mul(249,165)}don't()+why()where()'~mul(472,202),select(554,790)mul(387,509)~&!mul(514,914)who()from()when()mul(673,224)@where()/</mul(113,935)@;mul(900,18)~(mul(246,115)mul$!-^%'@!#)@mul(39,411)$^-mul*how() {$mul(791,482)what()/ when()don't()#why(168,204) how()$(!&mul(293,987)$?where(934,585)what()'mul(118,985)>++)+{ +mul(480,948)$/when()don't()&,mul(584,391) @+mul(180,685)who()select()'-!!$~mul+?mul(249,664)why()select()<mul(200,510)#(}select()mul(902,883)+when()mul(552,250))(what()select()(^(where()when()mul(310,298)who()how()/}select()#!/usr/bin/perl)<)how(),)how()'{@mul(438,954)mul(658,687)
:<mul^'}how()mul(611,205)where(86,446){when()how()-from()mul(662,949):select(){{[[from()'!mul(275,341)';-;~mul(889,976)@:^#who(43,814)mul(105,170)) ::*why(88,387)[ mul(136,219)+> mul(627,626)'$who()how()~mul%)@+;[{mul(237,229)who()%<{-{*]+;mul(809,56)#~}'mul(691,801)(:}['{<-/mul(990,19)select()where()what()':who(194,310)!^{mul(972,914)];&>mul(823,879)mul(531,912)how(640,856)^who()%!@mul(988,624)why() ^~[mul(593,75)what()*}]#-mul(238,652)$why(){#:$,)mul(351,278)@select() @[*/'mul(41,175)mul(723,126)&+how()/when()%mul(495,494what(25,590)why():]*$(mul(760,407) mul(208,295)*when()&'}do()@ }&when()/~who()what()^mul(613,494) why()%~@who()mul(159,575)why()where(390,372)%% ~from()-mul(570,730))mul(634,554)who()&how()mul(909,159)[[)+mul(481,13) mul(310,211)what()}why()from()how()< $why()mul(235,144):${how()^?;!]mul(601,971)mul(3,148)>))mul(351,281)from()&why(){!from()mul(398,4)why()when()#>mul(779,170)+)when()@>]/]mul(374,400)mul(725,109)from() *-<[+'mul(771,683)where()how()%+(,(mul(968,53)['who()@>[@(select():mul(650,309)#*,mul(676/#how()@select()^}%<where();mul(725,606),#mul(492,472)@>>from())mul(428,451)%}where()({%{>what()how()mul(840,189)how()mul(734,158)[:#what()&&(when() -mul(302,951){-what()>%[+mul(86,676)!mul(574,410)/*who()mul(709,782)mul:how()[)%-&from()mul(903,410)&~^!why()select()>when()how()mul(501,677)&,where()$)>'mul(572,739){mul(26,438)(*where()^'&mul(437,403)where()what()mul@&[<*)[:#%%mul(523,163)mul(401,39%&/]>mul(712,673)mul(593,248) mul(910,410)+?mul(60,141)-who()?~'mul(798,372)mul(469,939)(select()^[!-'mul(243,488)&/+-/^what()>^>mul(618,943 ('mul(252,224)*!$mul(619,792)from()&^mul(218,278){,mul(416,669)+*$]#mul(800,119)%]%^#$;*>{mul(482,893)'&&?how()mul(89,677)&)#<from(826,136)-+where()/>mul(483,457)why()[select()(!+;[mul(134,789)]~how() #%mul(837,402)~,?>*mul(128,824)<select()&#+ mul(306,537)where()mul(263,130)/<,~@where()who();?mul(297,684): mul(366,263)!;'^mul(957,894)mul(725,81)~ /{ ~mul(310,669)#mul(674,149)[mul(237,259){+)$^<+%{mul(237,745)when()}[what(779,966)>[/#@don't()what()$[&mul(181,943)[mul(678,31)~$:who()when()@ *what()mul(141,981)>!!~,/mul(169,72)where()why(),+*mul(347,11)~what(),when(): when()]mul(283,646)?'mul(834,247)[mul(744,766)()*mul(979,782)$;mul(864,806)?from()mul(836,818){%mul(662,438)mul(174,824)<mul(637,437)from()-}[?>'who()+select()mul(614,265)^select()mul(141,687)+**)[~$[/-mul(61,197)from() when()mul(498,859)who()@>why()how()how()mul(494<mul(357,897)mul(947,905)+~<^mul(672,858)how()how()&}%mul(340,814)}^^<mul(701,475)>when()!^^don't()when()mul(29,653){why()mul(41,526)#select()from()mul(715,903)
@where(957,13)how(451,967):?(/mul(884,339)&: -mul(895,988)%:from()mul(267,780)do()+!mul(747,812)[*;:&-##[,mul(877,201)@[from()(<{)<$mul(696,261)where()/??&-$:where()mul(451,383)#how()}$>,mul(966,386)~-#from()!when()/what()select()mul(893,103)/ ; /;-select(467,60)why(139,346)?mul(650,959)why(884,941)+why()<mul(848,148)how()what()(}who()*}>mul(353,814)from()who(){-*#who()mul(400,173)mul(661^$[[:*?mul(731,905)&(mul(317,300)!^< [/-how(){when()mul(476,578)who()from()&}-)mul(628,306)who():~',+@mul(633,755)$?^&mul(45,740)mul(495,369)how()when()!select()mul(809,627){when() what()mul(625,205)%/select()$(where():why()^when()don't()<where()?where()< [#mul(36,868))when())~mul@-<:@what();mul(68,63)+[%@@how()%~why()mul(831,988)!who(160,84)how()<-;{mul(927,989)select()) who() mul(994,339?^>>/:?mul(825,853):when()&~,(~select()]<mul(935,352)#} $^where(690,579)where(213,186):don't())why() +,,mul(666,304)}}&when()}mul(637,787)how()-why()>~mul(660,614)]+mul(968,860)-do()%select()~ mul(843,731!$}how()mul(354,619)@select()mul(354,560)when()}*mul(994,176)~]#how(549,822)[mul(887,251)[select()&*%who(17,670)who()%)&mul(360,653)-/''>from(803,726)mulwhere()?what()&mul(446,573):select()?how():&mul(660,62);[;)/?!@ when()mul(131,738)~;)mul(222,467)how()@},who()>why()mul(907,236)-$]^mul(389,882){mul(481,917)how()--!{when()mul(826,862)!what(776,585)%*from()/^mul(258,741)&+@[,&from()^?>mul(615,874))#where()who()^from()'(what()mul]#mul(239,843)where()where()!&mul(35,752)#}}how()))mul(103,32)'>]mul(491,16)%$'mul(914,334)~select()/'!@mul(256,451) ~%[$why()?mul(330,802)where(){(?mul(373,28[#:&/&'%%mul(227,364))mul]:mul(650,371)@@?[$from()mul(358,277)mul(102,94)%)';mul(431,297)>!when()*mul(83,650)#;/'@<)!/mul(444,600)+(*mul(342,980)$;mul(887,991)@mul(942,266)mul(554,806)[{why()who(), )select(){mul(560,307)^)mul(90,988)*:[mul(362}&don't()]where()what()!?!$mul(646,5)[+&(;;/^mul(70?'mul(768,397)]where()#(%don't()-how()~select()^how()@mul(969,59)<[how(288,620)who()>what()?from(925,90)mul(644,250)@+)@how()from()?from()mul(370,958)}mul(856,740)don't()](<#->!who()*mul(127,512)where(155,111)&$**>?mul(568,551)(when();$} (why()#mul(696,66)]~{/]mul(54,72)}mul(723,615)#mul(746,486)['*mul(890,144)!mul(139,363)mul(203,759),<;mul(954,65)when()*mul(122,219)^what()who(31,222)how()when()how()mul(235,569)what(934,341)from(545,730)/who()*^mul(344,502)where()~-] $>$mul(473,194)mul(514,408)do()when()['mul(592,732)mul(668,655){what()]>+?mul(897,859)~$select()]mulwhere()mul(116,140)@+what()&#mul(843,710)/$%~; @mul(329,45)~?<who():'@?/mul(178,435)+;what()/mul(224when(),do()!$mul(29,457)::;;;do()(when()>?@mul(751,862)?>mul(465,182)mul(879,670)select()}<)how()select(342,147)^why()-why(77,328)mul(839,63){from()mul(609,495)who())??#@%&}mul(791,585)mul(89,505)who() ~who()  $do()$;][mul(208,816)$;mul(162,345)?)what()*#^$]what()mul(239,645)from(),{@mul(225,844)select()'why(609,236)}?[mul(364,169)(select()!mul(273,586)
from()where()'%'where()<{?}mul(758,234)from(443,726)select()when()}'mul(884,68)**/[&{;~mul(818,66)why()where()>,from()-?;{mul(282,741)?['>mul(560,385)why()]@&$]<>]from()do()}/*^!}{mul(142,84)$from()who()how()mul:mul(225,76),how() (#how()mul(685,905)when()!!^['(^mul(744,487)-mul(837,928)from()<$((mul(776,854)mul(668,869)!who()mul(123,137)%-mul(76,346)-where()select()^}mul(912,946)'$#!mul(930,449)(,where(),$-how(){do()&what(),]when(){mul(665,336)$don't()<%why()]-}why()how()mul(705,882)select()+%-&#mul(162,959)select(),/*^^why()-+?mul(665,535)~?what()(select()how()from()how()^what()mul(968,599){,~##how()#-,(mul(620,224)^{+ mul(864,140)where()mul(169,847):why()?what()+don't()mul(251,569)/#%>mul(956,70);:mul(200,261)>!@when()):<^+:mul(899,267)who()#,&from()what()when(473,423)'from()mul(521,38)(why()/why()>^/]?mul(881,241)#'*(/mul(991,447)*mul(481,364)!what()$+^%mul{-what()}:+;mul(260,175),}$+what()mul(476,265)who()how();%#mul(444,418)>)select()from()why()'mul(189,265)@[({}mul(736,742)when()],mul(689,493)+ ^#[:don't()<mul(855,735[!-why()~?*mul(229,961)<:mul(706,567)@when(923,459)?)from()mul(540,764)-@select()!;)how(882,29)@~from()mul(641,652) why(396,613)?}when()from()when(){mul(395,627)>where()select()#mul(524,647)where()'%#!}(mul(466,834)))%where()~>!]mul(841,130)%select()>how()<select()mul(127,544)'{>why();mul(511,221)when()<!]mul(583,651)%mul(278,443)'-/mul(964,156);don't()/who()]#;$<@mul(787,906)>-mul(295,571)<*};why()?[~mul(749,813) ~*(why()^why() mul(74,836)%:%(/>/%)mul(148,705)&mul(973,710)]!}:]from()!who()-mul(751,18)/#[from()>/'what()/mul(451,419)how()^where(),&>'mul(21,960){+-{<mul(842,588)/}mul(505,70)#who()}%{how()@(%?mul(166,516)'!<who()when()}/-!mul(204,793)>'mul(305,674)%]&*- {-],mul(241,623)!]who()how();%don't()mul(987,838)+mul(495,346)>#*[what()@[select()don't()??:^select(),)mul(83,151);;]:-'#from()when()who()mul(641,58)<$,where()!why()+mul(698,90)from()mul(289,417)^from()who()<+>mul(280,434)!mul(510,875)select()from()]mul(63,720)from()*{who(140,649)- how() -]mul(310,719)[;why()mul(199,500)>who()mul(150,452)why()^mul(573,483)mul(194,434)select()$]$++mul(793,362)}where():*when()&:who())mul(448,657)who()don't()?-:-[!'mul(557,248)! @/why()[<)when(245,258)%mul(874,939)what()^from())mul(55,802)^%,&?select(431,807)}from(331,380)~where()mul(714,95)$?,mul(574,272)mul(895,71)){how(),/]mul(600,135)mul(875,178)]}$^ ?what()?{]mul(55,317)(^)(mul(474,170)when())]!what()mul(872,189)'from()where()( [$<)mul(948,648)-^[&#mul(308,675)[what()]from():(mul(547,600)how()who()~[what()~+who()mul(107,328)~([:+mul(982,96)>:mul(100,141)*'&(~where()[mul(528,201)>what())/~^<what()mul(646,182)what()# (-mul(439,233)mul(647,936)~()mul(99,510)[&~>:;mul(10,602)"#;

#[allow(dead_code)]
const TEST2: &str = r#"7 6 4 2 1
1 2 7 8 9
9 7 6 2 1
1 3 2 4 5
8 6 4 4 1
1 3 6 7 9"#;

const INPUT2: &str = r#"35 37 38 41 43 41
64 66 69 71 72 72
45 47 50 51 52 53 55 59
16 18 19 20 23 29
36 39 41 43 44 41 44
42 45 46 44 42
82 85 86 87 88 86 86
42 45 46 45 47 51
57 60 62 65 63 65 70
88 90 90 93 95 97
54 56 58 59 60 60 62 61
64 66 68 68 70 73 73
5 8 11 11 15
82 84 84 87 89 91 97
62 65 69 71 73
46 48 50 51 55 58 59 57
10 11 15 18 18
26 28 31 34 38 41 45
40 41 42 45 47 51 53 60
19 22 25 30 32
77 78 84 85 88 85
25 27 32 33 34 37 37
77 79 84 87 89 91 92 96
10 12 18 19 25
52 51 54 57 59 62 64
65 62 65 66 63
71 69 71 72 73 75 76 76
70 69 71 72 73 75 79
9 7 10 11 12 17
18 15 18 19 17 20
24 22 23 26 29 30 29 26
94 91 89 90 91 91
18 15 16 15 16 20
72 69 67 68 73
66 63 64 66 66 67 70
78 76 76 77 79 76
59 56 57 57 58 61 61
10 9 12 14 17 17 21
3 2 5 7 8 8 9 16
78 76 79 81 85 87
31 29 30 32 35 36 40 39
75 73 75 77 80 84 84
65 63 65 69 70 74
75 73 74 75 79 80 81 88
55 52 53 55 61 62
68 65 66 69 75 74
6 5 8 15 15
70 68 69 72 79 81 85
11 9 12 19 20 27
33 33 35 37 39
88 88 89 92 93 94 96 95
69 69 72 74 77 78 78
1 1 2 3 7
58 58 61 64 66 69 70 76
9 9 11 13 14 16 14 15
40 40 42 44 43 46 44
26 26 24 26 26
74 74 77 79 80 81 78 82
72 72 74 72 75 78 80 86
45 45 47 47 48
48 48 51 52 53 53 52
86 86 87 90 90 91 93 93
64 64 66 68 70 70 74
46 46 46 47 48 50 57
39 39 41 45 47 48 49
2 2 5 9 10 8
36 36 37 41 42 45 48 48
8 8 11 14 17 20 24 28
13 13 14 18 24
50 50 51 54 61 63
54 54 55 58 60 67 64
19 19 21 27 29 29
10 10 17 19 23
31 31 34 36 37 44 50
34 38 39 40 43 46 47 50
12 16 18 21 24 27 29 26
75 79 82 84 87 87
36 40 41 44 45 47 51
58 62 63 66 69 71 72 79
33 37 35 36 37 38 40
95 99 97 99 96
20 24 26 23 23
81 85 87 90 88 89 91 95
37 41 40 41 43 45 47 54
17 21 21 24 25 27 30 31
9 13 13 15 17 18 15
8 12 13 14 14 14
31 35 36 36 38 42
78 82 82 84 85 88 94
25 29 31 32 35 39 41 43
32 36 40 42 40
22 26 30 33 33
54 58 62 65 69
61 65 69 72 73 80
52 56 63 64 66
76 80 86 89 86
6 10 11 14 19 19
8 12 13 14 15 22 23 27
48 52 53 56 58 65 72
6 13 14 17 20 21
65 71 73 74 77 78 81 80
80 85 88 91 92 95 96 96
79 85 88 89 93
36 41 43 46 47 49 55
54 59 57 58 59
77 84 86 84 85 83
2 9 11 12 9 11 11
82 88 87 90 94
22 27 30 33 35 38 37 43
72 77 79 79 81 83
82 89 92 94 96 96 94
65 72 73 73 73
42 49 52 52 54 57 61
76 81 81 82 83 89
20 25 26 30 31
6 11 12 16 15
20 26 27 31 33 36 36
7 14 17 21 25
37 44 47 50 51 52 56 61
53 58 60 63 69 71 72
40 47 54 55 54
58 65 72 75 77 80 81 81
13 18 20 21 27 31
51 58 59 66 73
64 61 60 59 62
87 84 81 80 78 77 74 74
98 95 93 91 89 87 84 80
42 40 37 35 33 26
77 75 72 70 72 69 67
86 85 84 86 88
68 66 63 66 66
63 60 61 60 59 57 54 50
86 83 84 83 82 79 74
81 80 79 79 77 74
76 75 75 73 72 69 71
20 17 17 15 15
77 76 73 73 69
63 62 61 61 60 55
89 86 82 80 78 75
92 91 90 89 88 84 82 85
87 86 83 80 79 75 75
86 83 81 77 73
79 76 75 73 69 62
88 86 81 80 78
88 86 85 82 77 80
57 55 54 51 49 42 40 40
47 44 41 35 33 31 27
29 26 20 17 16 14 7
49 51 48 45 42 40
62 65 62 59 56 54 55
54 56 54 51 51
83 85 83 80 77 74 70
37 38 37 36 35 28
39 42 39 40 39 38 37
19 21 20 17 16 13 15 18
8 11 9 7 8 8
70 72 70 67 68 64
85 87 84 86 79
25 28 28 26 24 21
58 60 60 59 56 58
71 72 72 69 69
88 89 87 87 85 83 81 77
37 39 36 34 34 28
50 51 49 47 46 42 40
60 61 59 55 52 49 48 50
95 97 94 93 91 87 87
92 93 92 88 87 83
84 86 83 79 78 76 74 69
95 98 92 89 87 85 83
27 29 27 25 20 17 20
44 47 45 39 38 36 36
76 79 73 72 68
94 95 88 85 79
89 89 86 83 81 80 77 76
74 74 71 68 67 65 63 66
70 70 69 68 68
85 85 83 82 78
58 58 57 54 53 47
18 18 20 19 17 14 12 11
49 49 47 44 42 43 44
43 43 41 40 38 35 36 36
25 25 27 26 24 21 17
50 50 53 51 46
92 92 89 89 86 83 81 79
65 65 65 62 65
91 91 91 89 88 88
75 75 75 72 68
77 77 74 71 71 66
29 29 25 24 21 18
52 52 51 47 46 44 45
99 99 95 94 91 90 90
38 38 36 33 31 27 23
41 41 40 36 30
81 81 80 74 73 72 71 68
46 46 44 41 40 34 31 32
55 55 53 51 50 47 41 41
66 66 65 64 59 55
22 22 21 19 17 16 10 4
17 13 10 7 6 4 3
25 21 19 18 15 14 16
38 34 31 28 26 25 25
75 71 68 67 64 62 60 56
83 79 76 73 72 70 69 64
51 47 44 45 42 41
46 42 45 42 45
89 85 84 86 84 81 80 80
23 19 16 14 15 11
61 57 54 57 56 54 49
85 81 81 80 79 77 74
12 8 7 5 3 2 2 5
97 93 90 90 89 89
75 71 70 67 67 64 60
36 32 29 29 28 21
40 36 35 32 29 25 24 22
98 94 90 89 88 85 87
19 15 11 9 6 6
40 36 33 31 27 24 20
78 74 70 68 61
49 45 44 41 36 33
67 63 62 56 53 54
83 79 72 70 67 66 66
30 26 20 17 14 13 9
65 61 55 52 46
91 85 83 81 78 76 75
80 73 70 68 65 62 61 63
35 30 28 25 22 22
50 43 42 39 35
50 44 43 41 36
98 92 95 92 91 90 89
43 37 36 33 30 28 30 32
47 40 38 41 40 39 37 37
48 42 39 37 38 34
49 43 41 40 42 41 35
34 27 26 24 24 22
89 83 81 81 78 80
97 90 88 88 86 86
84 78 76 76 74 73 69
80 75 72 72 70 65
19 14 13 9 8 6 3
81 75 73 69 66 63 65
58 52 48 46 44 44
64 59 58 56 54 52 48 44
56 49 46 44 40 37 30
52 47 41 38 35
80 73 71 70 68 63 64
77 70 63 60 57 57
63 57 51 48 47 45 41
35 28 26 20 18 16 9
79 75 75 73 71 68
96 96 90 87 89
42 37 36 33 35 33
46 50 52 55 57 61 64
28 24 20 19 17 17
33 31 32 35 36 40 42 47
49 46 44 45 48 49 55
14 19 20 20 22 21
19 20 16 13 10 9 6 4
29 25 19 17 10
42 35 31 28 24
73 70 67 67 65 65
39 38 39 40 43 44 51 52
57 59 61 65 67 68 68
87 94 93 94 97 98
91 94 94 93 92
59 66 67 70 73 74 79 86
28 31 28 23 22 18
55 62 65 67 68 71 73 76
29 28 27 24 19 18 16 12
85 89 90 92 90 91 93 97
36 31 28 31 24
85 82 84 87 93 95 99
36 37 34 36 42
62 62 61 54 52 51 50 45
87 89 83 82 80 78 76
22 22 24 22 19 19
29 36 37 38 38 41 43
55 58 56 52 48
38 38 41 43 43 43
63 61 59 56 53 52 49 42
56 63 67 70 73 75 75
67 63 61 59 56 53 49 47
76 77 79 81 82 87
62 58 56 55 56 55 52 52
62 62 63 66 70
52 51 55 56 59 60
86 79 78 73 71
79 79 75 73 70 69
38 39 40 38 38
62 66 67 70 73 75 79
36 30 29 27 22 20 19 14
86 86 86 88 90 96
28 28 25 23 20 20
31 37 41 43 45 49
88 87 84 86 87 89 89
82 82 81 78 78 76 77
43 41 46 49 52 55 56 56
62 64 66 70 71 74 75 74
69 76 73 75 76 78 78
94 88 85 82 82 79 79
37 30 28 27 21
11 11 9 7 2
31 27 26 23 22 22 19 21
52 48 46 45 47 45 43
59 53 51 47 44 41 39 41
66 64 67 69 71 73 73
68 68 71 72 73 74 72 71
64 57 60 57 56 57
55 61 64 65 72 75 77 78
30 29 29 27 30
45 45 47 49 52 56 60
56 62 63 66 72 76
36 43 45 45 45
83 87 88 91 94 95 96 97
33 26 25 22 18
81 78 75 73 71 68 71 65
27 25 28 29 32 35 34
59 59 57 57 56
84 84 87 88 93 94 94
49 52 52 55 61
87 90 88 82 80 77 74 74
4 9 10 11 11 18
82 86 87 89 91 94 97 94
88 84 87 86 82
12 9 9 12 13 16 18 16
51 47 44 41 39 36 34
34 34 39 41 44 46 50
22 22 20 20 19 18 17 17
76 78 76 73 70 69 65
7 8 9 12 12
21 23 24 25 27 26 29 28
37 36 32 30 29 28 28
83 80 79 76 70 68 68
13 17 17 20 17
23 23 20 17 16 11 9 5
26 26 30 32 35 38 38
32 31 30 29 27 24 24
30 34 40 43 47
62 68 68 69 71 72 76
60 57 57 59 60 63
24 20 19 19 18 14
42 39 36 35 38
64 68 69 73 71
42 35 34 32 31 28 27 24
53 55 54 51 50 48 41
66 66 62 60 60
78 82 79 81 79
53 53 52 51 50 49 50 51
11 9 12 15 19
45 49 51 52 53 57 64
17 20 24 25 26
74 77 75 73 72 67 62
81 80 74 72 70 68 66
88 87 90 90 90
45 42 40 33 30 24
54 61 64 62 65 66 69 75
35 39 39 40 42 44
85 90 92 94 97 95 98 96
48 47 44 43 42 45 44 47
30 33 35 37 36
84 84 83 80 78 72 72
3 5 6 7 10 10 14
80 79 82 79 76 74 70
28 34 38 41 47
66 61 58 60 56
94 90 89 86 83 77 76 76
86 84 86 87 91 91
80 83 80 73 70 69 71
77 76 78 80 77 79 82 86
62 57 56 51 53
67 70 71 73 75 77 83 83
28 22 15 13 11 7
50 50 52 53 56 53 56
32 32 29 25 18
16 17 16 15 11 11
34 35 32 31 34 33 33
64 62 60 59 57 55 55 48
29 30 28 27 25 23 21
14 11 14 20 26
4 7 11 12 13 14 17 22
94 96 93 89 88 85 80
79 79 80 83 83 87
48 47 48 51 52 53 55
45 50 51 52 54 52
1 1 4 5 7 10 8
41 43 41 39 39 34
54 56 60 62 66
87 83 81 78 76 73 70 73
84 78 76 74 70 70
71 70 76 78 79 80 81 80
36 39 36 37 36 34 31 29
67 71 74 75 72 73
68 68 66 63 59
39 35 33 32 29 29
35 36 38 40 43 41 43 47
34 34 32 30 32
49 52 50 53 51 46
89 86 86 88 94
35 37 35 33 32 29 27 29
16 15 13 15 16 14
14 14 16 16 19 20
41 37 35 31 27
9 13 16 19 21 21 23 23
95 95 91 89 86 84 82 83
11 14 21 24 25
30 30 24 22 19 16 13
36 40 42 47 52
52 56 58 65 65
47 42 40 37 34 36 36
78 78 80 82 83 82 86
62 62 58 55 51
87 80 77 77 75 73 67
90 86 84 81 80 79 74 71
98 96 96 95 93
11 12 15 20 23 26 30
97 90 90 89 87 85
20 20 22 20 27
78 80 81 81 83 83
96 92 93 90 87 86 80
71 70 71 73 75 79 77
38 38 39 40 43 44 45 51
74 67 61 58 55 53 53
31 38 41 42 43 45 52
19 19 17 19 17 11
81 83 81 78 76 76
93 89 87 85 85 84 84
13 13 12 10 12 11
40 36 34 32 25
10 14 18 19 23
33 38 35 38 41 42 46
62 58 52 49 45
9 13 14 11 12 12
82 83 84 85 90 96
74 70 68 66 65 63 59
31 38 42 43 46
43 47 51 54 55 55
48 48 52 54 55 53
29 29 30 36 39 45
20 20 21 23 26 27 27
24 31 34 36 39 41 45 44
84 83 87 88 92
45 44 39 37 35 33 32 33
28 21 19 19 21
24 20 19 15 17
93 92 89 88 85 84 83 79
32 32 32 30 27 26 22
21 21 21 22 21
19 16 12 11 6
32 36 36 38 45
92 92 90 88 88 81
88 85 82 78 74
67 70 68 65 65 63 64
18 24 29 32 31
55 48 45 42 40 38 37 37
22 23 24 25 27 27 28 30
2 6 9 11 13 10 15
65 67 69 72 75 80 78
60 60 62 66 73
61 61 62 61 61
6 9 12 10 7 3
83 81 83 81 81
98 95 98 95 92 89 87
82 85 87 89 90 94
64 68 69 70 73 75 77 83
68 64 63 61 59 55 52 46
67 71 73 76 76
64 63 59 58 61
81 80 78 76 75 71 70
38 45 48 49 52 53 54 54
31 32 30 33 34 37
48 48 50 47 44 43 42 38
24 20 18 15 15 12 7
52 47 46 46 43 41 37
57 61 68 70 67
38 40 38 37 37 37
60 53 51 50 48 44 42 40
69 67 64 64 63 59
59 58 57 55 52
29 30 32 33 35 38
41 42 44 46 47
54 57 58 59 60 62 65 66
26 27 28 31 33 34 36 37
34 31 30 29 28 27
29 30 32 34 37
52 53 55 58 61 64 65 67
31 32 35 36 37 38 39
85 82 80 79 76
56 54 52 51 50 49
16 15 13 10 7 6
2 4 6 7 8 11
67 70 72 73 76 79 81 83
27 24 23 22 20 18 15
8 10 12 13 14 16
23 22 20 17 14 11 8 5
50 49 48 46 45 44 41
37 35 33 31 30 27 25 23
19 17 16 14 13 10 8 7
78 75 74 72 69 67 65
10 11 14 15 18 19 21 23
55 53 51 48 46
71 74 75 78 81 83 84 86
21 24 27 30 31
46 49 50 51 53 54 55 58
19 18 15 14 12 10
13 14 17 20 21
63 62 60 59 56 54 52 49
73 76 78 79 82 84 85 87
54 51 50 47 45 42
57 55 52 50 47 44 41
34 32 29 26 23 21 18 15
89 88 85 84 81 78
55 58 61 64 66 68 71
67 69 72 74 77
32 29 28 25 23 20 19 16
29 30 31 33 34 37 39 41
70 67 65 62 59
66 64 62 59 58
84 86 89 91 92 93
69 71 74 77 78 79 81 83
31 28 26 25 24 22 19 17
96 95 94 91 90 88
82 85 87 88 89 92 94
30 28 27 25 23 22 20
68 65 62 60 58 57 56 53
52 53 55 57 58 60
38 35 34 31 29 28 25
40 38 36 35 34 33 31
31 32 34 37 38 40 41
35 37 40 42 44 46
45 43 40 39 38 37
46 48 51 53 55 56 59 60
26 27 29 32 34 37 40
90 91 93 96 99
78 79 80 83 84
24 25 27 28 30 33 36
97 94 93 90 89 88
58 60 61 64 66 67
82 81 80 77 74 72 69 68
82 83 84 87 90
72 73 76 78 81 84 85
25 26 28 30 33 36 38 39
87 86 83 80 79 76 73
23 24 27 29 30 31 32
60 62 65 67 70 71 72
54 56 58 61 63
45 43 40 37 35 32 31 30
41 42 43 44 46
31 34 37 40 43 45
66 68 69 72 75
78 80 83 86 89 92 94 95
86 84 82 79 78 76
94 93 92 91 88 85 82 80
18 16 14 12 11
71 69 66 64 62 60 59
88 91 92 93 96
54 57 58 61 63 64 67 69
96 95 94 92 91 90 87
28 25 23 20 18 17 14 12
88 91 92 94 97
51 54 56 58 60 63 66 68
26 27 30 32 35
70 71 73 76 77 78
14 12 10 7 4 2
4 7 9 11 13 16
64 63 62 61 58
26 29 32 33 35 37 40
81 84 87 89 90
29 30 31 33 36
31 29 26 23 20
91 90 88 87 84 83 80 79
31 33 34 37 39 41 42
73 71 70 67 64 63 61 58
90 88 85 84 82 81 80 79
14 11 10 9 8 7 4
50 52 55 58 61 62
39 36 33 32 30
84 87 88 89 90 93
20 22 23 24 27 28
94 91 88 86 83 80
21 23 25 28 29 32 33
27 26 23 21 20
70 71 73 75 76 79 82
24 27 28 29 30
11 13 15 17 19 21 22
58 57 56 53 50 49
73 74 76 78 79 80 82 85
49 48 46 45 43
25 28 29 31 33 34
79 77 74 72 70 68
78 76 74 72 69 67 66
86 84 83 80 78
69 67 66 65 64 63 62 59
26 24 22 20 18 15
63 66 67 69 71 73 76
45 44 41 40 38
92 91 90 88 87
16 17 20 21 22 23
12 14 15 16 19
76 79 82 83 86
28 26 25 23 20 19 17 15
47 46 44 43 40 39
97 94 93 90 89 88 85 83
8 11 13 16 17
4 6 9 12 15 18
72 69 68 66 63 62 60 57
67 68 69 71 73 74
36 35 33 32 30
59 56 55 52 51 50
8 11 14 15 17
57 60 63 65 67 70 73 75
72 75 76 78 79 81 84 85
9 11 14 15 18 20
71 72 73 75 77 78 79 81
60 59 58 55 54 51 49
46 44 42 40 39 36
70 71 72 73 75 76
70 69 66 64 62 61
63 66 67 70 73 74 75
22 25 28 29 31 34 35
97 94 91 90 87 85 84 83
95 93 90 89 86 85 84 83
92 89 87 86 85 83 81
75 72 70 68 67
85 82 81 79 76
34 36 38 39 40 41 42 44
29 27 24 22 21
36 35 33 30 28 26 23
63 64 67 68 70 73
76 78 81 84 86
35 33 32 30 27
31 28 27 24 22 19
46 43 42 39 37 34 31 29
71 72 75 78 79 80 83
4 5 6 7 9 10
66 67 70 71 73 74 77 80
75 74 72 71 68
84 82 81 79 78 77 75 72
34 33 32 30 29
47 48 51 54 56 59 60 63
93 90 87 86 84 83
24 25 27 30 32 35 37
75 77 80 81 83 85 87
82 79 77 75 72 70
74 75 78 80 81 84 86 88
82 79 78 77 76 73 71 68
69 66 64 63 60 57 56 54
21 18 16 13 11
38 39 42 44 45 47 49 52
73 74 76 78 81 82
12 15 18 19 20 23 25 27
30 33 35 36 39 40
79 81 82 85 86 87 89 90
15 16 18 21 24
34 35 37 39 42 43
10 11 14 15 18
35 37 38 40 43 46 47
50 53 55 57 59 61 62 64
90 92 93 94 96
2 4 6 7 9
22 21 18 16 15 13 10 8
1 2 4 7 10 13 14 17
25 23 21 19 16 14 11 10
36 33 32 31 28 26
57 60 63 65 66 69 71
35 36 38 39 41 43 44
13 14 16 17 18 20
33 30 29 27 24 23 21
48 45 44 42 41 39
97 95 92 91 88 85
83 80 79 76 73
73 71 69 67 64 61 58 56
78 79 82 85 86 87 90
12 14 17 19 21 22 23 25
25 26 29 31 32 33 36 38
29 26 25 24 23 22 20
48 46 44 41 38 35 33 32
74 73 72 71 70 67 64
90 89 86 83 82 81 79 76
30 32 33 36 39 40 41 43
12 14 16 18 21 22 23 25
21 19 18 16 15
41 42 43 44 45 48 50 53
25 27 30 31 34
29 31 34 35 36 39 40 43
78 75 74 73 70 67
85 84 82 81 80 79
77 76 75 73 72 69 66 65
22 24 26 27 30 33 35 37
11 12 14 17 20 22 23
78 79 81 82 84
62 65 68 69 71 74
30 31 34 37 39 42 43 46
22 23 25 28 31 32 35 36
2 4 6 7 8
14 11 8 7 6 5 4 1
44 45 48 49 51 54
37 38 39 42 45 46
98 96 94 93 90 87
51 52 54 56 57 58
13 14 15 18 20 22
49 46 45 44 43
60 61 62 63 64 67
90 87 84 82 81
62 60 59 58 55 53 50
92 91 89 87 85 82
66 64 63 60 58 55 54 53
84 86 88 90 93 94 96
23 24 25 27 28 30 32 35
55 58 59 61 62 63 64 65
52 53 54 56 57 58 61
84 83 81 80 78 75
29 27 24 21 20 19 17
45 46 47 49 50 51 53 54
34 36 38 40 41 42 44
74 76 78 81 84 85 87
6 7 10 13 14 17 20 21
37 35 32 31 29
77 79 80 83 86 87
84 83 81 79 76 75
31 32 33 35 36 39
47 50 51 53 55 57 60
6 9 10 11 14 16 18
22 23 26 28 29 30 33 35
95 93 92 89 88 86
30 33 34 36 37 39 41
59 56 54 52 51 49 46 44
49 50 53 56 57 58
10 12 13 14 17
77 78 81 83 85 87 90 93
89 88 85 83 81
97 96 94 93 92 91 90 88
40 42 43 45 48 49
96 93 90 87 84
46 49 52 53 54 55 57
70 67 65 64 63
60 58 55 54 53 51 49
78 80 83 86 89 91 93
42 39 37 35 32 31 30
69 71 74 77 79
46 48 50 52 54
1 2 4 5 8 10
15 12 11 9 7
70 72 75 76 79 82 85
66 67 70 72 74 75
3 6 8 10 13 16
5 8 11 13 15 18
83 82 81 78 76 75
22 21 18 16 14 11
86 83 82 81 80 78 77 76
99 98 95 92 90 88 86 84
69 67 65 64 63
14 15 18 21 23 25 27
77 78 80 81 84 86 87
97 94 91 88 85 84 82 81
7 8 9 10 11
42 43 44 46 48 51
97 95 92 91 90 87
81 82 83 84 86 87 89 92
69 70 71 74 77 80 82 83
68 70 73 76 79
29 26 23 22 20 17
4 6 8 11 13 14
36 38 39 40 41 42
4 5 7 9 11 14 17 20
35 33 30 28 27 24 21
59 61 62 63 65 68 70
5 8 11 13 14 15 18
56 58 59 62 65 67 70
65 66 69 70 71 74 75
15 17 18 19 22 23
46 45 43 42 39 37 34 31
65 62 60 59 58
29 26 23 21 19 18
65 63 62 60 58 56 53
16 13 11 8 5 2 1
75 73 71 70 69
89 86 84 82 81 79 78 76
85 83 82 81 80 79 78 77
95 92 90 89 87 85 82
56 59 61 64 66 69
84 85 87 90 91
10 11 13 15 18 19
67 65 63 60 58 56 55
82 85 86 89 91 92
80 79 78 75 72
54 51 49 46 45 43
81 79 76 75 74 71 70 67
58 60 62 63 66 69
85 84 83 81 78 77 75
59 61 63 66 68
38 36 34 31 30
59 62 65 66 68
70 69 67 66 65 64 62 60
31 29 28 25 24 21 19 16
49 46 44 43 40 39 38
20 18 17 16 14 11 9
80 78 75 73 72 70 67
71 70 69 68 66 65 63 61
49 52 54 57 59 60 61
38 41 43 46 47 50
44 41 39 37 34 33
80 79 76 75 74
20 23 26 29 31 32 33 36
76 78 79 82 84
29 27 26 23 21
22 25 28 31 32 33
30 28 26 23 21
10 12 15 18 19 22
57 59 62 64 65 67 68
85 82 80 77 76 73 71 68
29 28 26 24 21 18 17
11 12 15 16 17 20
53 52 49 46 45 42
64 65 67 70 72 74 77 78
4 5 8 11 14
43 44 45 46 47 50 52 55
88 89 92 95 96 99
1 3 6 9 10 13
44 43 41 38 36
72 69 66 63 61 58
69 70 73 76 79 81
85 87 89 90 93 96
64 62 60 57 56 53 51 50
75 77 79 81 83 85
6 8 9 11 12
57 58 61 62 64 67
14 13 10 7 6 4 1
66 69 71 72 75 76
22 20 19 16 14
57 54 53 50 47 46 43 40
18 16 15 14 12 9 8
80 79 76 75 72 69 66 63
9 10 11 12 15 16 17
27 28 31 33 36 39
37 36 33 32 31 30 27
71 69 67 64 61 58 55
46 45 44 41 39 36
21 18 15 13 10
38 36 33 31 30 27 26 24
11 13 16 17 19 21 24 27
21 24 26 29 30 33
94 92 89 88 85 84 81 79
13 15 16 17 18
58 59 61 63 66
23 25 27 29 32 35 36
56 59 61 63 66 69 71 74
84 85 88 89 92 95
78 81 84 87 90 91 93
26 25 22 21 19 16
44 41 38 37 36 33
80 79 78 76 74 72 70 68
27 29 30 32 35 36
75 73 72 70 67 64 61 60
59 61 64 66 69 72 73
39 38 36 34 31 30 27 25
3 4 5 7 10 11
73 75 76 77 80 81
58 60 62 65 68 69
76 79 80 83 86 89 90 91
12 9 6 3 2 1
52 53 54 56 59 61 62 64
72 73 74 77 79
75 72 71 70 69 66 63
48 46 45 44 43 42 39
70 71 73 74 76 79 81 84
90 93 96 98 99
45 46 47 50 53 55 58 61
65 68 69 72 73 75 78 81
47 46 43 40 37 34
13 12 9 8 6 5 4 1
80 77 75 73 72 69 67 66
40 42 44 46 47 50
64 67 68 69 72 73 74 76
1 3 6 8 9 11
24 21 20 18 17
53 56 58 60 62 65
77 78 80 83 85 87
8 10 13 16 19 21 23
30 28 26 24 22
27 25 22 19 18 17
79 76 73 71 69 68 65 62
79 76 74 72 70
72 71 68 66 63 62 61 59
51 53 54 55 57 60 61 64
82 85 86 87 90 91 93 95
32 31 28 26 24 23 22
80 77 74 71 68
63 60 59 56 53
97 96 93 91 88 87
19 17 14 11 9
36 38 41 43 46 49 51 52
53 56 59 62 63 65 66
78 81 83 85 88 89 92 94
11 12 13 16 17
34 37 38 39 42
51 48 45 44 41 40
37 35 34 32 30 29 28 26
79 76 75 73 71 69 67 65
74 71 68 66 63 62 60
87 88 89 90 93 95
33 30 29 26 25 23 22 19
27 26 24 22 19 17 15 13
39 38 37 36 35 33 32
52 49 46 43 42 40 37
33 36 39 41 43 46
29 28 27 26 24 21
66 68 70 71 72 73
38 37 34 33 31
90 89 88 86 84 81 80 78
23 25 27 30 31 33
49 47 44 42 41 38 37
88 85 84 81 78
42 44 45 46 47 49 51
35 37 38 40 41 42 45
94 95 96 97 98
39 36 33 32 29 26
58 60 61 63 64
52 51 49 47 45
23 22 21 19 16 15 13 11
4 5 6 8 9 11 12 15
6 7 9 11 14 16 19 21
30 33 34 35 36
16 19 21 22 24 25 27
64 65 68 71 73 74 76 78
68 66 64 62 59 58 56 54
56 53 51 48 45 44 41 39
17 15 12 11 9 6
53 54 56 57 60 62
21 19 16 15 14 13 10 9
12 11 8 6 4 2
94 92 89 88 86 84 83 82
18 20 23 24 25
39 41 44 47 49 52 55 58
83 82 79 77 74 73 72 69
81 82 83 84 85 87 90
53 54 55 57 58
33 30 27 25 24 22 19
87 88 90 93 94 95 98
77 76 73 72 71 68 65 63
93 92 89 88 87 86
67 64 63 60 58 55
93 91 90 88 86 84
80 82 83 86 88 91 94 97
19 22 25 27 28 31
66 69 70 71 74 76
86 84 81 79 76 74 72 69
21 22 25 27 28
64 67 70 71 72 73
45 42 39 36 35
80 81 84 85 87 90 92 94
41 40 37 34 32 30 29 26
25 22 19 16 13 11 10 7
7 9 12 14 15
51 54 57 59 62 64 67
28 29 31 32 35 36 39
70 73 75 78 80 81 83
88 90 91 93 94 96
58 57 55 52 51 49
31 30 27 24 22 19
43 44 45 47 49 51
84 82 81 79 76 74
58 57 54 52 49 46 45
45 46 48 49 52
16 18 21 23 26 27
24 26 27 29 32 34 35
64 66 68 69 70 72 75 78
28 27 24 23 21 18 16
63 66 67 68 71 73 75
99 96 93 92 89
19 21 23 25 26 27 30 33
40 42 45 47 50 53
61 64 65 66 67
61 58 56 54 52 49
82 83 85 88 89
49 46 45 43 42 41 39
65 66 67 69 72 74 75
92 93 94 96 97
38 39 42 45 47 48 50
49 46 43 42 40
51 50 48 45 42 40 39
66 64 62 60 57 54 51
66 65 63 62 60 58 55
76 78 80 83 86 88
69 70 72 74 75 76
70 72 74 75 76 79
96 95 93 90 87 85 83 81
95 94 91 89 87 84 82
13 15 16 19 20 23
14 16 19 20 23 26
13 10 7 6 5 3
58 57 56 53 52 50
16 14 12 9 7 6 3
74 71 70 69 67 64 62 61
75 72 69 67 66
80 77 76 74 72 71 70 67
79 82 85 88 89 91 93 95
42 41 39 36 34 33 32
10 12 13 16 17
14 12 10 7 5 3
47 49 50 52 53 54 57 59
28 29 32 33 34"#;

const INPUT: &str = r#"97924   12015
50267   32019
98415   10716
64856   63472
73972   11396
85009   60876
16084   81584
63342   45754
36722   57910
71800   33139
13657   42097
31646   60883
13033   45362
98175   50742
12224   82309
26745   36160
91733   22906
63235   23212
34149   43474
55819   92797
89877   82309
63876   68418
35017   24286
71693   56515
67230   56504
32107   70146
29455   43966
10294   80966
11503   97276
45021   44890
65889   45042
22646   50684
29246   40041
94894   64304
97487   32858
11658   25139
86638   37390
77389   69681
20834   20641
43948   97853
25169   18624
47469   14334
77677   51466
67863   10346
66135   44506
22510   90140
39330   56504
96958   57081
65629   98292
40599   32865
41131   50742
41361   91497
44833   76741
32056   53741
15025   58921
32170   52656
95391   10777
55371   78010
48305   51466
65862   89174
40636   54184
97450   99374
77105   83865
34812   41764
23999   77192
25503   93924
66670   24286
30994   12382
76175   60974
43005   50445
53741   14287
67639   60769
68473   53741
16078   76080
51006   54184
74520   49015
17232   40707
25445   89174
39404   16084
23041   85801
54140   17286
46419   20749
49484   46855
19164   86911
39289   12150
59326   22031
47693   53741
89369   86087
78926   99284
46255   78050
53879   65533
27064   21120
21756   63733
46201   58079
83358   45402
67814   39702
36582   27906
68742   32858
63598   80368
46069   15449
43061   21120
82842   43966
47757   41841
11761   26946
55059   78870
73640   28789
87885   16294
76819   42168
99933   82831
96701   43783
33926   50742
53211   50456
63392   97067
86076   89174
22252   52322
82469   52960
15384   19277
17446   62973
60995   85599
67563   99208
81796   42097
13959   65386
67714   81831
98828   55717
66905   59486
12690   99284
24626   21468
14738   49115
58555   17335
23470   27139
38356   94975
21420   34794
85109   99284
88215   16754
13822   56504
78720   97465
17622   49756
27946   39646
42737   85951
39857   51466
98335   73635
51079   27139
75618   80096
55716   22031
44439   79910
74943   85951
15914   69859
94892   51466
89851   26946
58970   40772
89048   21927
79217   43966
22327   21545
15513   56526
52584   39743
17822   37390
50437   45539
26861   99284
39402   43966
44176   98943
93367   38719
85462   35314
70936   30406
64975   53741
69603   40772
27447   43966
48913   50742
55729   17033
55903   55600
58608   73308
13030   62519
79586   53741
85885   78724
47696   26716
89036   95563
51691   35314
74369   27139
83246   50742
34233   53741
87921   48574
12660   51466
15408   54159
82361   21120
78963   99205
87395   10043
73712   24286
97972   97487
77207   34050
26598   21574
51812   47558
34508   90761
26436   40460
71011   60574
50890   51466
50493   24854
16217   47118
44890   73772
44429   26946
99607   43966
38107   99307
10208   32858
73098   45260
26515   70155
53750   55600
74904   44506
89898   43966
71445   37467
77746   82076
20131   34528
67840   12429
36620   80900
18892   95044
73474   85951
83450   24551
45728   11046
66927   40772
35585   85951
93945   83865
76199   18892
26536   16084
58275   26910
51874   42097
88833   57054
75871   85642
67764   32556
69526   26946
19475   16084
80585   90761
34189   82309
96205   55600
11371   24399
38079   51194
99465   44890
21120   99284
15731   84749
82309   28950
33121   47050
84859   31889
93071   22719
69403   40772
47701   55127
94758   12405
71944   40772
59059   27139
23522   48009
69897   20227
96432   53857
40161   56742
99974   31605
28726   40772
43411   19960
52521   51466
10024   51312
84954   35314
33296   99284
77780   49638
89571   26843
13582   87187
27081   74290
29330   26946
35469   42097
96455   60260
44473   20645
52280   90488
36181   17193
83515   89920
77203   22203
31113   70569
93446   50742
94776   14334
65132   74481
76822   22765
76108   25212
88359   81025
58602   89174
71874   21120
78276   98125
39092   22656
62278   65305
40915   21120
55896   26933
89049   11422
73736   82035
41226   93643
91298   94509
48613   68016
48763   50742
72203   25900
83036   90823
40070   22471
34155   77007
66614   75044
99172   34719
10261   48242
75196   91994
60212   32858
82136   42097
68902   40955
61584   61094
18196   97838
12112   99284
28990   51912
21082   40991
45932   51466
71891   70388
93524   71891
36886   20645
84927   11097
90640   82280
12240   22031
50754   79877
12243   56504
21896   69022
27361   50742
92599   91087
50881   17965
19258   92324
48109   51450
39617   66508
33422   59580
24453   21120
70071   76583
61099   99284
32270   81634
18554   90140
57108   40772
72972   82180
44178   35314
58969   35314
68638   32858
59752   97487
91349   85951
42541   91799
11241   85951
56014   40772
18240   82309
83562   82349
99794   20645
49642   24286
26318   35314
20645   16436
95467   32543
85129   29179
63111   28393
21776   47366
17413   13453
39834   96167
54442   65122
25618   90140
67027   50742
91899   59045
36861   84429
41069   24405
39818   26532
41305   57846
50844   54184
35314   52839
13646   66988
21610   72792
84316   67867
37390   27139
33072   38672
50742   68302
95333   44890
67978   10314
54472   77425
65124   64037
62367   57908
88774   40958
71725   85651
27200   73263
72832   16084
93194   20645
84331   87651
83654   96024
98518   44506
26270   85951
17471   54184
40445   40716
24801   98329
71775   48960
63886   62621
11574   58455
36092   85951
70761   10112
61291   26292
97303   19625
44506   86054
91586   95307
58301   40772
81698   27139
72921   26946
50502   36406
16298   86304
75558   37706
22495   99284
33661   82309
85183   85951
57125   55600
32610   99284
61179   38278
59372   93008
74037   14334
48967   43966
57442   16159
26047   21120
23188   89174
23633   16084
15300   57527
11726   50556
59493   94320
66596   32570
78092   75310
48254   42097
23338   50742
36327   78906
14142   94284
26946   68750
51040   40772
69209   40772
15882   54414
31997   14334
12496   32775
54801   60587
92254   34864
54184   56224
50128   37390
46755   37390
68205   42097
16526   31984
33415   89174
95561   99284
58231   11999
12000   27968
13762   24130
20783   29706
49870   13617
31028   85455
73097   31238
36095   22031
15523   97714
41560   34014
30530   90052
34128   97988
91541   54184
97402   68624
14133   22098
95923   88909
21065   76908
54343   27139
17923   52386
39271   97487
54329   47300
29173   12083
73679   66145
25043   79638
23367   27139
47733   73848
50178   19841
61856   75136
12334   99284
24075   99000
66813   16084
68591   37390
60548   26946
47476   51466
65067   34238
27139   43966
90127   90140
71661   53741
76564   86323
14606   74629
33073   20645
28929   99210
20290   16026
55600   31919
44895   95367
69018   51466
19996   10788
79035   39402
59205   55228
38746   94339
86509   76500
99613   75251
21577   12189
97880   60387
91425   85951
84219   85951
82752   51466
24031   14334
21843   51466
67480   16084
89728   72818
28954   99145
88314   89174
18726   32858
87526   25968
85951   85741
64143   78312
42517   49699
13848   22031
43260   35799
53772   81476
54544   99120
38528   26946
75966   82991
66179   95509
58180   45829
53138   99284
43795   67657
75091   16278
82097   47194
58590   11318
50521   83696
27323   81208
33112   99284
27922   49371
65787   90869
40517   36120
20919   48795
30416   63304
88719   50742
79993   75970
27124   51458
35850   70479
47642   30113
56934   42097
99900   51466
21591   33043
97673   89174
29342   22031
75687   90761
45898   50821
22897   63031
23889   77846
63662   48377
65299   75957
44563   99284
60281   51466
49181   35314
50909   52749
21600   11254
44988   13205
58351   33964
84132   90140
33795   94103
30993   90836
23660   42097
56833   67799
84296   30712
27172   23612
41123   64339
70231   50742
65636   35314
24047   72155
11869   60279
44666   91711
81159   79500
75418   66073
18982   51466
54865   26946
91042   14334
21791   89073
86188   22769
92550   56504
63942   48743
55260   92181
97155   69816
44593   25507
94520   37390
16803   31162
99284   94474
10940   16434
51986   32334
94727   54184
79564   22031
67524   42754
96074   54184
32231   87988
82182   11698
36414   29276
16281   28226
21085   86754
98238   43817
53299   42097
19359   93023
46340   72842
16355   51322
70234   51466
50841   13798
81149   71891
58011   53741
80355   58080
62858   56427
25160   14155
29287   26946
82307   37276
45594   10162
52167   67510
66037   18892
16339   26946
74466   59737
68243   96568
70410   82183
18833   81661
52684   20077
99904   14334
64936   32858
67435   35314
25168   51466
48685   52200
87833   43966
16974   56000
82852   91407
54986   42097
56112   49272
64314   67342
66607   54466
61959   45397
20294   14988
22416   99280
15287   22031
42081   17788
69276   85883
19958   89174
14337   24625
43966   45494
56772   64995
37195   65787
71264   60398
45446   14947
27319   54184
71714   56504
98898   54184
15964   53181
35923   34140
92462   99284
70969   21414
60163   81686
26799   45525
57327   92053
19339   51466
56504   91566
53113   44890
78876   51902
96200   89174
82490   70725
44316   36065
71051   88682
89880   22031
27972   74592
58858   41411
31090   64119
99124   40772
77060   35314
67020   25937
28781   22031
58289   99284
89174   50742
38323   63710
42607   42383
12543   89055
23349   38990
70058   59526
15437   50742
59862   98161
30674   37596
14449   18706
42471   22031
41124   32858
77330   44890
91002   14369
12075   40772
51581   75361
17412   76932
57784   38581
78558   99284
68326   18310
33313   54184
18353   52449
91690   32831
31047   33504
41819   19604
97743   65016
81549   20645
72159   33409
38296   27139
39901   97487
26924   14334
77429   52218
90666   42785
25384   60133
61440   92089
42764   30200
26668   94108
44171   93942
96575   54184
77777   25665
65805   84579
66448   48617
66204   20645
67751   33623
48577   64139
14034   62738
82234   33385
94447   92116
21669   80984
76758   43995
16998   91461
10808   14581
91668   92007
42411   65834
83439   51090
57286   56504
26423   85951
47687   90581
75978   35314
79027   96347
13122   76475
43173   64852
33696   85951
26050   53741
29903   49202
55762   67069
22725   93128
92748   37390
75292   46134
84901   83013
82424   53741
49756   10496
99049   95224
21549   42097
45030   90831
42687   43966
24675   43966
64330   78889
26258   21120
11886   18810
10674   55709
80983   36441
73290   20645
91623   50742
68510   82209
96050   27139
29559   40772
87297   79655
16161   22031
69453   73178
79979   36506
28404   82655
95222   38807
61168   81721
39809   74305
24627   16084
48823   82344
22852   44523
67111   26946
22838   97487
19454   33107
84203   54184
97780   35714
53203   27139
89425   97487
16614   18100
19219   99284
20569   82309
48161   40982
17213   31332
70935   40772
86566   78489
24611   91868
54359   97873
95758   54184
20532   73488
49070   58755
66014   54184
69011   69128
54241   99864
61068   82574
64852   26325
60260   90900
26299   10028
58452   27139
26134   22031
84291   31012
94851   23134
90147   21120
88435   46853
26639   32875
98570   64925
66700   61354
57045   31104
30983   77622
77419   62276
61144   34934
79828   81916
38801   34632
71141   73192
30543   33571
33787   93024
93255   97304
27104   93186
43923   23461
70069   73947
23376   79180
82293   51960
37692   27139
91328   69682
47801   37390
90140   50742
40772   21893
77630   62221
26106   24286
82191   79832
29674   85951
32858   35263
57709   50742
70834   74783
34807   23868
40646   93606
17334   72970
79995   39402
22031   14334
59137   40772
23515   23407
69665   59362
78363   31953
74969   85136
51172   40772
11229   98531
86385   53822
71049   73230
90321   64852
15381   24392
17377   14334
35732   26946
92220   98405
75143   22448
93217   22031
12345   80271
66240   40772
63460   31057
14334   59725
52629   82139
67549   57710
32589   21120
40973   51466
48086   64809
62405   56431
69385   65345
73015   28247
47116   35314
89461   53741
89978   37390
45093   43966
95580   20645
90761   22983
61770   37390
91506   17021
37148   58211
73119   29135
83826   16084
11602   46435
79485   43966
51373   14334
71333   50742
41091   71891
60255   11833
70778   44890
76205   26946
67609   32858
65250   83865
81623   12242
20105   17154
53573   89174
67594   55600
30437   56504
74127   98641
43012   24286
82823   90761
87461   43966
35267   22031
99386   71177
47451   23934
51886   43966
45000   98769
93502   69179
26127   42438
61492   44506
16858   20657
77633   89949
29357   86929
91974   85951
87979   14334
12707   83865
38824   83968
46482   25275
69244   35249
10765   99284
30619   53741
30590   55600
99292   85951
28244   43966
18494   85951
91105   44506
73930   26946
30813   85951
67308   94250
54758   85951
43568   33487
15869   34016
82010   27139
33131   52450
57985   12045
93101   51270
15835   64414
24286   23491
56944   11795
47755   10809
82704   75027
93787   90140
51466   20555
51856   14334
30252   44890
44052   31936
20691   68431
57033   63455
13300   43535
33712   84239
97080   51559
91808   22031
90652   22031
64155   44890
65463   40772
44798   52819
43936   44156
18253   27360
73289   89174
71164   56212
34646   20645
42097   89582
15990   55600
56628   41785
68636   89174
67043   16186
25652   34811
87109   70679
83865   43966
54773   24922
12778   27139
41699   62346
59666   17557
94699   37390
77535   27125
19069   18324
34344   51466
24906   41267
91226   76330
58992   17879
21084   37390
95352   27424
14593   14167
57258   79480
41550   98477
59908   49327
63930   56501
52103   49712
98431   19293
64232   64852
10638   14334
52217   35314
11797   27139
12501   53741
39316   73238
62625   54184
54433   27493
23801   35877
15292   50742
28822   55302
90501   18892
52285   33785
42385   21120
34500   97487
39882   93726
12013   47966
42691   18536
57217   14334
31320   58173
90532   42331
65216   54184
78393   42097
48315   29944
37332   48362
40774   98927
16062   28783
73931   39391
54344   21435
17846   56504
61807   42097
93272   97487"#;
